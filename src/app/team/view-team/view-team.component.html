<mat-card *ngIf="team" style="width: 95%; margin: auto;">
    <div fxLayout="row">
        <mat-card-header>
            <mat-card-title>{{team.name}}</mat-card-title>
            <mat-card-subtitle>{{team.description}}</mat-card-subtitle>
        </mat-card-header>
        <span style="flex: 1 1 auto;"></span>
        <button mat-icon-button (click)="showTeamCardContent = !showTeamCardContent">
            <mat-icon> {{showTeamCardContent ? 'expand_less' : 'expand_more'}} </mat-icon>
        </button>
    </div>

    <mat-card-actions *ngIf="showTeamCardContent" align="end">
        <button mat-button [disabled]="!userIsAdmin" (click)="onEdit()">
            <mat-icon>edit</mat-icon>
            <span>Editar</span>
        </button>

        <button mat-button [disabled]="userIsAdmin">
            <mat-icon>blur_on</mat-icon>
            <span>Excluir</span>
        </button>
    </mat-card-actions>

</mat-card>

<mat-tab-group>

    <mat-tab label="Membros">

        <div style="width: 90%; padding: 5px;" fxLayout="row" fxLayoutAlign="start center">
            <h2 style="margin: 0%;">Membros da Equipe ({{dataSourceMembers.data.length}})</h2>
          </div>

        <table style="width: 100%" #members mat-table [dataSource]="dataSourceMembers" class="mat-elevation-z8">

            <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef> Nome </th>
                <td mat-cell *matCellDef="let element">
                    <div fxLayout="row" fxFlexAlign="start center">
                        <mat-list dense>
                            <mat-list-item>
                                <img matListAvatar src='https://material.angular.io/assets/img/examples/shiba1.jpg'
                                    alt="...">
                            </mat-list-item>
                        </mat-list>
                        <span style="padding: 0px; margin-top: auto; margin-bottom: auto">{{element.name}} </span>
                        <mat-icon style="padding: 0px; margin-top: auto; margin-bottom: auto" *ngIf="element.isAdmin"
                            matTooltip="Administrador do Grupo">assignment_ind</mat-icon>
                    </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="email">
                <th mat-header-cell *matHeaderCellDef> E-mail </th>
                <td mat-cell *matCellDef="let element"> {{element.email}} </td>
            </ng-container>

            <ng-container matColumnDef="position">
                <th mat-header-cell *matHeaderCellDef> Cargo </th>
                <td mat-cell *matCellDef="let element"> {{element.position}} </td>
            </ng-container>

            <ng-container matColumnDef="expand">
                <th mat-header-cell *matHeaderCellDef> # </th>
                <td mat-cell *matCellDef="let element">
                    <button mat-icon-button (click)="openBottomSheet(element.id)">
                        <mat-icon>more_vert</mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumnsMembers"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsMembers;"></tr>
        </table>

    </mat-tab>


    <mat-tab label="Sistemas">
        <div style="width: 90%; padding: 5px;" fxLayout="row" fxLayoutAlign="start center">
            <h2 style="margin: 0%;">Sistemas da Equipe ({{dataSourceSystems.data.length}})</h2>
            <span style="flex: 1 1 auto;"></span>
            <button mat-raised-button (click)="onAddSystem()">
                <mat-icon>add</mat-icon>
                <span>Sistema</span>
            </button>
        </div>

        <table style="width: 100%" #systems mat-table [dataSource]="dataSourceSystems" class="mat-elevation-z8">

            <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef> Nome </th>
                <td mat-cell *matCellDef="let element"> {{element.name}} </td>
            </ng-container>

            <ng-container matColumnDef="description">
                <th mat-header-cell *matHeaderCellDef> Descrição </th>
                <td mat-cell *matCellDef="let element"> {{element.description}} </td>
            </ng-container>

            <ng-container matColumnDef="action">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let element">
                    <button mat-icon-button (click)="onViewSystem(element.id)">
                        <mat-icon>open_in_new</mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumnsSystems"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsSystems;"></tr>
        </table>
    </mat-tab>

    <mat-tab label="Posts">
        <div style="width: 90%; padding: 5px;" fxLayout="row" fxLayoutAlign="start center">
            <h2 style="margin: 0%;">Posts desta Equipe ({{posts.length}})</h2>
            <span style="flex: 1 1 auto;"></span>
            <button mat-raised-button>
                <mat-icon>add</mat-icon>
                <span>Criar Post</span>
            </button>
        </div>
        <br>
        <div *ngFor="let post of posts">
            <mat-card class="post-card" >

                <div fxLayout="row" fxLayoutAlign="start center" (click)="viewPost(post.id!)">
                    <h1>{{post.title}}</h1>
                    <span style="flex: 1 1 auto;"></span>
                    <button mat-icon-button (click)="viewPost(post.id!)">
                        <mat-icon>open_in_new</mat-icon>
                    </button>
                </div>

                <mat-card-header>
                    <img mat-card-avatar class="avatar-image" [src]="getAuthor(post.usrId)?.photoUrl">
                    <mat-card-title> {{getAuthor(post.usrId)?.name ?? 'user_name'}} </mat-card-title>
                    <mat-card-subtitle>publicado em: {{toDate(post.created)}}</mat-card-subtitle>
                </mat-card-header>
                <mat-card-actions align="end">
                    <button mat-button (click)="toggleLike(post.id!)">
                        <mat-icon *ngIf="post.liked.length > 0">thumb_up_alt</mat-icon>
                        <mat-icon *ngIf="post.liked.length <= 0">thumb_up_off_alt</mat-icon>
                        <span>&nbsp; {{post.liked.length}}</span>
                    </button>
                    <button mat-button [disabled]="userViewed(post.id!)">
                        <mat-icon>visibility</mat-icon>
                        <span>&nbsp; {{post.viewed.length}}</span>
                    </button>
                </mat-card-actions>
            </mat-card>
            <br>
        </div>
    </mat-tab>
</mat-tab-group>



<div fxLayoutAlign="center center">
    <mat-spinner *ngIf='isLoading'></mat-spinner>
</div>



<br><br>
<!-- <span>{{team | json}}</span> -->